---
title: "SQL"
output: html_document
---

##Filtering Columns and Rows

With SQL you can filter columns and rows by using SELECT and WHERE. Let's look at an example using the Lahman database. So we should first load that database, along with the package sqdlf.

```{r message=FALSE, warning=FALSE}
library(Lahman)
library(sqldf)
```

suppose now I would like to see the home run totals for the 1927 Yankees. I could write the following query:

```{r}
query<-"select playerID,yearID,teamID,HR from Batting
where teamID='NYA'and yearID=1927"
sqldf(query)
```

Let's try another example. we want to find instances where the Yankees have hit 40 or more home runs. I would write the query this way:
```{r}
query<-"Select playerID,yearID,teamID,HR from Batting
Where teamID='NYA' and HR>=40"
sqldf(query)
```

Now we want to see instances when a player had more than 40 home runs but less than 60 strikeouts. This is how the query would look:
```{r}
query<-"select playerID,yearID,teamID,HR,SO from Batting
where HR>=40 and SO<60"
sqldf(query)
```

Let's do a tougher example. We want to find instances where the Phillies in the 1970's hit more than 30 home runs. The tricky part is figuring out how to display data between 1970 and 1979. This is how I wrote the query:
```{r}
query<-"Select playerID,teamID,yearID,HR from Batting 
where teamID='PHI' and yearID<1980 and yearID>1969 and HR>30"
sqldf(query)
```

##Order by 

With SQL, you can also order the rows of your output. Suppose we would like to see all instances of a player hitting more than 50 home runs with the highest home run totals at the top. The query is written like this:

```{r}
query<-"select playerID,teamID,yearID,HR from Batting
Where HR>50
Order by HR DESC"
sqldf(query)
```

